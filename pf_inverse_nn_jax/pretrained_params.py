import numpy as onp

pretrained_params = [[onp.array([[-1.6308511,  5.7814856,  0.9983506, -1.4362664,  2.222735 ,
        -4.698684 , -3.1438763,  2.6849918]], dtype=float), onp.array([-0.70018935, -4.235691  , -0.06604219, -0.8975166 ,  2.6541936 ,
       -1.8625648 , -3.7876513 , -3.5687802 ], dtype=float)], [onp.array([[-1.0436057 , -0.56791306,  0.797803  ,  0.94059914,  0.1862173 ,
        -1.7413145 , -1.5053577 ,  0.14419979],
       [-5.766165  ,  1.536468  , -0.8303569 , -6.757765  ,  1.9091779 ,
         1.5229999 ,  2.2334669 , -0.564869  ],
       [ 3.2100346 , -0.99916565,  1.7234846 , -0.7621031 ,  3.2859945 ,
         0.13246237,  1.0466759 , -0.28105924],
       [-2.682176  , -0.93337935,  1.184069  ,  2.1630988 , -1.7371868 ,
        -1.5035503 , -1.7957611 , -0.16649239],
       [ 1.0627173 ,  1.1007167 , -1.7781721 ,  2.357126  ,  2.9700522 ,
         3.3756366 ,  1.1945462 , -1.1294504 ],
       [-0.77863806, -0.04196909, -0.5544381 ,  1.5906231 , -2.1167495 ,
         2.5322075 , -0.39195228, -1.0254412 ],
       [-1.717919  ,  0.01406309,  0.35479063,  2.9688623 , -5.3287034 ,
        -0.7424383 ,  0.40063664,  2.3019886 ],
       [ 4.954351  , -2.6436067 ,  1.9467541 ,  0.55841446,  2.4502301 ,
         0.28887978,  0.0231459 ,  2.803204  ]], dtype=float), onp.array([ 0.3239807 , -0.55761385,  0.44108838,  0.9532761 ,  1.4639099 ,
       -1.2046142 , -1.1032295 ,  0.5182873 ], dtype=float)], [onp.array([[ 1.5310771 ],
       [-0.9114782 ],
       [ 1.1965389 ],
       [-0.73451835],
       [ 1.2897117 ],
       [-2.2908413 ],
       [-1.1737267 ],
       [ 1.4418225 ]], dtype=float), onp.array([0.6093063], dtype=float)]]

pretrained_norm = 400

if __name__ == "__main__":
    # plot pretrained model

    import nn
    import matplotlib.pyplot as plt

    pretrained_params_dict = nn.params_list_to_dict(pretrained_params)

    u_lst = onp.linspace(-1.1, 1.1, 100)
    u_lst = u_lst[..., onp.newaxis]
    f_lst = nn.model.apply(pretrained_params_dict, u_lst)

    plt.figure()
    plt.plot(u_lst, f_lst)
    plt.show()
